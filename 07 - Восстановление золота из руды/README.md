# Восстановление золота из руды

Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Вам нужно:

Подготовить данные;
Провести исследовательский анализ данных;
Построить и обучить модель.
Чтобы выполнить проект, обращайтесь к библиотекам pandas, matplotlib и sklearn. Вам поможет их документация.


**Выводы:**
- Концентрация золота (Au) увеличивается после всех этапов очистки
- Концентрация серебра (Ag) в процессе очистки уменьшается. Вернее, сначала увеличивается после флотации, а затем начинает уменьшается
- Концентрация свинца (Pb) увеличивается после всех этапов очистки
- Также из графиков можно видеть, что у концентрации каждого вещества есть выбросы в 0
- Распределения размеров гранул исходного сырья на обучающей и тестовой выборках не сильно и не критично отличаются друг от друга, графики практически идентичны, поэтому модель можно обучать.
- В результате работы над этим пунктом, мы пришли к выводу, что суммарные концентрации металлов на разных стадиях очистки только возрастают, поэтому предполагаем, что очистка эффективна.
- По построенным графикам было замечено, что наблюдается большое количество выбросов в нуле (то есть суммарная концентрация металлов в этих местах равняется 0, что фактически невозможно). Все суммарные концентрации меньше 1 были удалены из тренировочного датасета, и сейчас в нем нет выбросов в районе нуля, а график распределения практически не поменялся.




Был написана функция, вычислячющая sMAPE, а также функция, вычисляющая sMAPE итоговый
Была проведена работа с выборками - количество признаков в тестовой и обучающей выборках было приведено к равному количеству. Также в тестовую выборку были добавлены целевые признаки из общего набора данных.
Были рассмотрены 3 модели для двух этапов - флоатация и очистка, гиперпараметры подбирались при помощи GridSearchCV, и вот такие результаты показали модели:


**Флоатация**

- DecisionTreeRegressor, sMAPE: -5.95
- RandomForestRegressor, sMAPE: -5.94
- Linear Regression, sMAPE: -6.43


**Очистка**

- DecisionTreeRegressor, sMAPE: -8.898
- RandomForestRegressor, sMAPE: -8.68
- Linear Regression, sMAPE: -9.11
Т

### Итоговый вывод
Наилучший результат **sMAPE на обоих этапах показала модель RandomForestRegressor**. Протестируем её на тестовой выборке, посчитаем итоговый sMAPE и проверим на адекватность. Для проверки использовался DummyRegressor, **итоговый sMAPE которого составило 8.42**

**Итоговый sMAPE модели на тестовой выборке = 7.32**, что меньше чем у DummyRegressor, поэтому модель прошла проверку на адекватность.